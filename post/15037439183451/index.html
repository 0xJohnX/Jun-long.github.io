<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        
        <meta name="twitter:card" content="summary_large_image"/>
        <meta name="twitter:image" content="https://i.loli.net/2017/08/25/599ff33529294.jpg"/>
    



<meta name="twitter:title" content="树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（2）：准备与安装 Home Assistant"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@"/>



  	<meta property="og:title" content="树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（2）：准备与安装 Home Assistant &middot; 智能改造家" />
  	<meta property="og:site_name" content="智能改造家" />
  	<meta property="og:url" content="https://junlongzhao.github.io/post/15037439183451/" />

    
       <meta property="og:image" content="https://i.loli.net/2017/08/25/599ff33529294.jpg"/>
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2017-08-24T21:49:19&#43;08:00" />

    
    

    <title>树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（2）：准备与安装 Home Assistant &middot; 智能改造家</title>

    
    <meta name="description" content="&lt;h2 id=&#34;写在前面&#34;&gt;写在前面&lt;/h2&gt;

&lt;p&gt;如果你看完了之前的文章，决定开始尝试一下打造个人的智能家居系统。那么恭喜你，你不但能解决谁下床关灯，大门到底关没关好的历史难题，还能够充分发挥个人的想象力，解决更多的家居问题。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;如果天气很热，你将在离家三公里远的时候，收到手机消息推送：" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://junlongzhao.github.io/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://junlongzhao.github.io/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="https://junlongzhao.github.io/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://junlongzhao.github.io/css/nav.css" />

    

    
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
        
        <script>hljs.initHighlightingOnLoad();</script>
    

    
        <link href="http://feeds.feedburner.com/..." rel="alternate" type="application/rss+xml" title="智能改造家" />
    
    <meta name="generator" content="Hugo 0.26" />

    <link rel="canonical" href="https://junlongzhao.github.io/post/15037439183451/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": ,
        "logo": https://junlongzhao.github.ioimages/logo.png
    },
    "author": {
        "@type": "Person",
        "name": ,
        
        "image": {
            "@type": "ImageObject",
            "url": https://junlongzhao.github.ioimages/logo.png,
            "width": 250,
            "height": 250
        }, 
        
        "url": http://vjeantet.fr,
        "sameAs": [
            
            
             
             
             
             
             
            
        ],
        "description": 智能改造家
        
    },
    "headline": 树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（2）：准备与安装 Home Assistant,
    "name": 树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（2）：准备与安装 Home Assistant,
    "wordCount": 157,
    "timeRequired": "PT1M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": en
    },
    "url": https://junlongzhao.github.io/post/15037439183451/,
    "datePublished": 2017-08-24T21:49Z,
    "dateModified": 2017-08-24T21:49Z,
    
    "image": {
        "@type": "ImageObject",
        "url": https://junlongzhao.github.iohttps://i.loli.net/2017/08/25/599ff33529294.jpg,
        "width": 3000,
        "height": 1445
    },
    
    
    "description": ,
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": https://junlongzhao.github.io/post/15037439183451/
    }
}
    </script>
    


    

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://junlongzhao.github.io/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://junlongzhao.github.io/post/">Archives</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="http://feeds.feedburner.com/...">Subscribe</a> </div>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">



  
  <header class="main-header post-head" style="background-image: url(https://i.loli.net/2017/08/25/599ff33529294.jpg)">
  
  <nav class="main-nav overlay clearfix">


  
      <a class="blog-logo" href="https://junlongzhao.github.io"><img src="https://junlongzhao.github.io/images/logo.png" alt="Home" /></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（2）：准备与安装 Home Assistant</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-08-24T21:49:19&#43;08:00">
            Aug 24, 2017
          </time>
        
         
        </section>
    </header>

    <section class="post-content">
      <h2 id="写在前面">写在前面</h2>

<p>如果你看完了之前的文章，决定开始尝试一下打造个人的智能家居系统。那么恭喜你，你不但能解决谁下床关灯，大门到底关没关好的历史难题，还能够充分发挥个人的想象力，解决更多的家居问题。</p>

<ul>
<li>如果天气很热，你将在离家三公里远的时候，收到手机消息推送：“是否打开空调？”</li>
<li>下雨了，如果窗户开着，系统会提醒你关窗，当然，如果有关窗器和雨水感应器，完全可以自动关窗。</li>
<li>基本的感应开关灯、门、窗……</li>
</ul>

<p></p>

<h2 id="一-基础准备">一、基础准备</h2>

<h4 id="1-树莓派相关">1. 树莓派相关</h4>

<p><img src="https://i.loli.net/2017/08/24/599e97c89605e.jpg" alt="树莓派 3 MODEL B" /></p>

<p>▲树莓派 3 MODEL B</p>

<p>考虑到智能家居的时效性以及经济性，一直开机、永远在线、低功耗、高性能的树莓派是我们的不二之选。作为整个系统的硬件平台，树莓派本身是<strong>不含任何操作系统</strong>的。你需再要购置一张 TF 卡，一个电源、一个读卡器。当然，在某宝和某东上你可以轻松购买到打包好的套装，价格在 300 元以内。</p>

<h4 id="2-home-assistant-安装方式选择">2. Home Assistant 安装方式选择</h4>

<p><img src="https://i.loli.net/2017/08/24/599e97a15e4f8.png" alt="Home Assistant 官网" /></p>

<p>▲Home Assistant 官网</p>

<p>经过众多版本的迭代以及社区成员的贡献，Home Assistant 支持大部分平台，包括 Docker、macOS、Linux、Windows 等。在树莓派上安装 Home Assistant 有多种方式，你可以选择在树莓派 Raspbian 系统下安装，也可以之间安装集成了 Home Assistant 的 Hassbian 操作系统。</p>

<p>由于面向零基础的玩家，尤其是代码恐惧症患者，我选择了 Home Assistant 于 2017年7月26日发布的 Hass.io 集成系统，全可视化安装配置，基 <a href="https://www.docker.com/">Docker</a> 和  <a href="https://resinos.io/">ResinOS</a> 。</p>

<blockquote>
<p>Docker 是一个软件容器平台，是一种新兴的虚拟化方式。抛开参数性能，对于开发者来说，它解决了运行环境一致性的问题，Docker 的镜像提供了除内核外完整的运行时环境。</p>

<p>ResinOS 是为容器设计的主机操作系统，作用于在嵌入式设备上运行 Docker 容器。</p>
</blockquote>

<p><img src="https://ooo.0o0.ooo/2017/08/24/599e97de4466d.png" alt="Hass.io 系统结构" /></p>

<p>▲Hass.io 系统结构</p>

<blockquote>
<p>Docker 的引入使得 Hass.io 管理功能插件就像你在手机上安装 App 一样简单（事实上 iOS 的底层确实采用了类似机制），再不用通过命令行和代码来管理你的 Home Assistant。同时，通过 Docker 来封装插件，使得插件的稳定性得到了极大提高，用户能够把精力集中在个性化定制 Home Assistant 及自动化上来。</p>
</blockquote>

<p>可以预见 Hass.io 是 Home Assistant 的发展方向，如果说它有什么缺点的话，那么也在于它的封闭性上。后期我会推出进阶教程，通过其他方法安装 Hass.io，解锁树莓派更多功用。</p>

<h4 id="3-其他准备">3. 其他准备</h4>

<p>准备好一些点心或者保持手机电量的充足，由于你懂的网络原因，你可能会经历安装 5 分钟，等待 2 小时的局面……</p>

<h2 id="二-安装">二、安装</h2>

<ol>
<li>下载适用于树莓派3 的 Hass.io 镜像。<a href="https://github.com/home-assistant/hassio-build/releases/download/1.0/resinos-hassio-1.0-raspberrypi3.img.bz2">下载地址</a></li>
</ol>

<blockquote>
<p>公众号的读者可点击“阅读原文”来通过浏览器阅读文章，或者在 “简书” 中搜索 “智能改造家”，所有文章同步发布。</p>
</blockquote>

<ol>
<li>将镜像文件烧录至 TF 卡。</li>
</ol>

<blockquote>
<p>推荐使用 <a href="https://etcher.io/">Etcher</a> （By <a href="https://resin.io/">resin.io</a>）</p>
</blockquote>

<p><img src="https://i.loli.net/2017/08/24/599e983f7482f.png" alt="Etcher" /></p>

<p>▲Etcher</p>

<ol>
<li>如果树莓派采用 WiFi 连接，在烧录完成后使用文本编译器打开 TF 卡目录下 <code>system-connections/resin-sample</code> 文件，修改填写你的 WiFi 信息：</li>
</ol>

<pre><code class="language-toml">   [connection]
   id=resin-wifi
   type=wifi

   [wifi]
   hidden=true
   mode=infrastructure
   ssid=你的 WiFi SSID

   [ipv4]
   method=auto

   [ipv6]
   addr-gen-mode=stable-privacy
   method=auto

   [wifi-security]
   auth-alg=open
   key-mgmt=wpa-psk
   psk=你的 WiFi 密码
</code></pre>

<p>其他请参考 <a href="https://docs.resin.io/deployment/network/2.0.0/">ResinOS 网络配置</a> 。</p>

<ol>
<li>将 TF 卡插入树莓派中，并保证树莓派处于联网状态。几分钟后，在浏览器（推荐 Chrome）地址栏输入<a href="http://hassio.local:8123/">http://hassio.local:8123</a>，你应该会看到如下界面。
<img src="https://i.loli.net/2017/08/24/599e9d00dca35.png" alt="Hass.io 初始化" /></li>
</ol>

<p>▲Hass.io 初始化</p>

<blockquote>
<p>初始化时，系统会更新到最新的版本，而显然 <a href="https://home-assistant.io/">Home Assistant</a> 没有国内服务器，所以不要相信 20 分钟的提示，不要切断电源，拿出之前准备的点心，享受一下难得的悠闲时光（煎熬等待）……</p>
</blockquote>

<p>几十分钟到几个小时不等的时间过后，终于安装成功，初始界面如下：
<img src="https://i.loli.net/2017/08/24/599ea2605b55b.png" alt="Hass.io 初始界面" /></p>

<p>▲Hass.io 初始界面</p>

<h2 id="三-下节预告">三、下节预告</h2>

<ul>
<li>Hass.io 插件（Add-ons）安装</li>
<li>系统配置与设备接入</li>
</ul>
    </section>


  <footer class="post-footer">


    








<figure class="author-image">
    <a class="img" href="https://junlongzhao.github.io" style="background-image: url(/images/logo.png)"><span class="hidden">Junlong's Picture</span></a>
</figure>


<section class="author">
  <h4><a href="https://junlongzhao.github.io">Junlong</a></h4>
  
  <p>智能改造家</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Hubei, China</span>
    <span class="author-link icon-link"><a href="http://vjeantet.fr">http://vjeantet.fr</a></span>
  </div>
</section>




    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=%e6%a0%91%e8%8e%93%e6%b4%be%20%2b%20Home%20Assistant%20%2b%20HomeKit%20%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e6%89%93%e9%80%a0%e4%b8%aa%e4%ba%ba%e6%99%ba%e8%83%bd%e5%ae%b6%e5%b1%85%e7%b3%bb%e7%bb%9f%ef%bc%882%ef%bc%89%ef%bc%9a%e5%87%86%e5%a4%87%e4%b8%8e%e5%ae%89%e8%a3%85%20Home%20Assistant&nbsp;-&nbsp;%e6%99%ba%e8%83%bd%e6%94%b9%e9%80%a0%e5%ae%b6&amp;url=https%3a%2f%2fjunlongzhao.github.io%2fpost%2f15037439183451%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjunlongzhao.github.io%2fpost%2f15037439183451%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fjunlongzhao.github.io%2fpost%2f15037439183451%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    







  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="background-image: url(https://i.loli.net/2017/08/25/599ff33505660.jpg)" href="https://junlongzhao.github.io/post/15037439183550/">
          <section class="post">
              <h2>树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（3）：初步配置 Home Assistant</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="background-image: url(https://i.loli.net/2017/08/18/59969202df8a8.jpg)" href="https://junlongzhao.github.io/post/15037439183374/">
          <section class="post">
              <h2>树莓派 &#43; Home Assistant &#43; HomeKit 从零开始打造个人智能家居系统（1）：前言</h2>
          </section>
      </a>
  
</aside>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">智能改造家</a> &copy; 2017</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="https://junlongzhao.github.io/js/jquery.js"></script>
    <script type="text/javascript" src="https://junlongzhao.github.io/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://junlongzhao.github.io/js/index.js"></script>
    
</body>
</html>

